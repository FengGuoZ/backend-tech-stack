## æ“ä½œç³»ç»Ÿ - è®¾è®¡ä¸å®ç°

> å—å¤§è’‹ç‚å²© 20220814

[RTFM](https://www.urbandictionary.com/define.php?term=rtfm): Read The Friendly Manual

[STFW](https://www.urbandictionary.com/define.php?term=stfw): Search The Friendly Web

å‰ç½® ã€Šé—®é¢˜æ±‚è§£ã€‹ã€Šè®¡ç®—æœºä½“ç³»ç»“æ„ã€‹ã€Šè®¡ç®—æœºç³»ç»Ÿã€‹ã€ŠCSAPPã€‹

### ç¬¬1ç«  æ“ä½œç³»ç»Ÿæ¦‚è¿°

![image-20220816155432074](https://figure-bed-zwd.oss-cn-hangzhou.aliyuncs.com/img_for_markdown/image-20220816155432074.png)

OSè´Ÿè´£ç®¡ç†

- memory
- devices
- file system
- program

æ“ä½œç³»ç»Ÿæ”¶ç¼–äº†æ‰€æœ‰è½¯ç¡¬ä»¶èµ„æº



**tldr** ç²¾ç®€ç‰ˆman

[tldrå®‰è£…](https://blog.csdn.net/tcliuwenwen/article/details/109548043?ops_request_misc=%7B%22request%5Fid%22%3A%22161745892216780271523017%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&request_id=161745892216780271523017&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2)

![image-20220816231650403](https://figure-bed-zwd.oss-cn-hangzhou.aliyuncs.com/img_for_markdown/image-20220816231650403.png)



**çŠ¶æ€æœº**

- çŠ¶æ€æœºåŒ…å«çŠ¶æ€ç©ºé—´(å€¼)å’Œå½¢å¼è¯­ä¹‰(åŠ¨ä½œ)

- æ•°å­—ç³»ç»Ÿæ˜¯çŠ¶æ€æœº


- **ç¨‹åºä¹Ÿæ˜¯çŠ¶æ€æœº**

  - **ç¨‹åºçš„çŠ¶æ€æŒ‡M,R**
    - memory register

  - M,Ræ”¹å˜å³çŠ¶æ€è¿ç§»

  - èŠ±è´¹çš„æ—¶é—´æ˜¯cpuæ—¶é’Ÿå‘¨æœŸ




**æ ˆå¸§**

- å‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­ï¼Œæ“ä½œç³»ç»Ÿå°†**æ ˆå¸§**å‹å…¥æ ˆå¸§é“¾

- æ ˆå¸§ä¸­åŒ…å«å‡½æ•°çŠ¶æ€å’Œ**æ ˆæ·±è®¡æ•°å™¨PC**



ç¨‹åº = è®¡ç®—â†’syscallâ†’è®¡ç®—â†’...



### ç¬¬2ç«  å¤šå¤„ç†å™¨ç¼–ç¨‹

Concurrent: existing happening done at the same time

**çº¿ç¨‹æ˜¯å¹¶å‘çš„åŸºæœ¬å•ä½**ï¼Œçº¿ç¨‹æ˜¯å…±äº«å†…å­˜çš„å¤šä¸ªæ‰§è¡Œæµ

- çº¿ç¨‹ä¹‹é—´å…±äº«å†…å­˜
- çº¿ç¨‹æœ‰ç‹¬ç«‹çš„æ ˆç©ºé—´



**å¹¶å‘æ¨¡å‹ä¸‹**

- å­˜åœ¨nä¸ªçº¿ç¨‹
  - å¯¹åº”næ¡æ ˆé“¾ï¼ˆnä¸ªæ‰§è¡Œæµï¼‰
  - æ ˆé“¾ä¸­çš„æ ˆå¸§ä¿¡æ¯ä¸å…±äº«
- å­˜åœ¨1ä¸ªé€‰æ‹©å™¨è´Ÿè´£pickæŸæ¡æ ˆé“¾è¿›è¡Œæ‰§è¡Œ
  - è¿™ç§pickæ˜¯éç¡®å®šçš„

<img src="https://figure-bed-zwd.oss-cn-hangzhou.aliyuncs.com/img_for_markdown/image-20220817171710846.png" alt="image-20220817171710846" style="zoom:50%;" />



**å¤šå¤„ç†å™¨ç¼–ç¨‹å…¥é—¨**

- å¤šå¤„ç†å™¨ç¨‹åº = çŠ¶æ€æœº
- å…±äº«å†…å­˜ï¼ˆçº¿ç¨‹é—´å†…å­˜èµ„æºå…±äº« éœ€ä¿è¯å†…å­˜ä¸€è‡´æ€§ï¼‰
- **éç¡®å®šæ€§é€‰æ‹©çº¿ç¨‹æ‰§è¡Œ**

**å¤šå¤„ç†å™¨ç¼–ç¨‹æ”¾å¼ƒ**

æ”¾å¼ƒå¯¹æ—§ç¨‹åºå•çº¿ç¨‹é¡ºåºæ‰§è¡Œçš„ç†è§£

- **åŸå­æ€§çš„ä¸§å¤±**ï¼Œçº¿ç¨‹ä¹‹é—´çš„CPUæ‰§è¡Œæƒåœ¨ä¸æ–­åˆ‡æ¢ï¼Œå³ä½¿i++ä¹Ÿä¸åŸå­
- **é¡ºåºæ€§çš„ä¸§å¤±**ï¼Œç¼–è¯‘åï¼Œcode_line2å¯èƒ½åœ¨code_line1å‰
  - ç”±ç¼–è¯‘å™¨ä¼˜åŒ–å¯¼è‡´
  - __sync_synchronize() å¯ç”¨äºå®ç° memory barrierï¼Œç¦æ­¢ç¼–è¯‘å™¨æ”¹å˜memory order
- **å¯è§æ€§çš„ä¸§å¤±**ï¼Œæ‰§è¡Œæ—¶ï¼Œop2å¯èƒ½åœ¨op1ä¹‹é—´è¢«æ‰§è¡Œ
  - ç”±å¤„ç†å™¨ä¹Ÿå¯èƒ½ä¼˜åŒ–
  - å¤„ç†å™¨ä¹Ÿæ˜¯ï¼ˆåŠ¨æ€ï¼‰ç¼–è¯‘å™¨



**mem-ordering.c**

çŠ¶æ€ç©ºé—´ä¸­æœ¬ä¸ä¼šå‡ºç°0 0

```bash
$ ./mem-ordering | head -n 100000 | sort | uniq -c	# bashæŒ‡ä»¤ä¼˜åŒ–ç»“æœæ˜¾ç¤º
```

![image-20220819010320944](https://figure-bed-zwd.oss-cn-hangzhou.aliyuncs.com/img_for_markdown/image-20220819010320944.png)





**Peterson ç®—æ³•**

åœ¨å…±äº«å†…å­˜ä¸Šå®ç°åŸå­æ€§(äº’æ–¥)

åŸºæœ¬å‡è®¾ï¼šæ¯æ­¥pcè§†ä¸ºåŸå­æ€§æ“ä½œ

```c++
void TA() {
    while (1) {
/* PC=1 */  x = 1;						// ä¸¾èµ·Açš„ğŸš©
/* PC=2 */  turn = B;					// é—¨ä¸Šå¸–Bçš„æ ‡ç­¾
/* PC=3 */  while (y && turn == B) ; 	// yæ²¡æœ‰ä¸¾ğŸš©æˆ–é—¨ä¸Šæ ‡ç­¾ä¸ºAåˆ™è¿›å…¥ä¸´ç•ŒåŒº
            critical_section();
/* PC=4 */  x = 0;						// æ”¾ä¸‹Açš„ğŸš©
    }
}

void TB() {
  while (1) {
/* PC=1 */  y = 1;
/* PC=2 */  turn = A;
/* PC=3 */  while (x && turn == A) ;
            critical_section();
/* PC=4 */  y = 0;
  }
}
```

![image-20220819172219271](https://figure-bed-zwd.oss-cn-hangzhou.aliyuncs.com/img_for_markdown/image-20220819172219271.png)



**UNIX Philosophyï¼šåªå†™èƒ½åˆä½œçš„code**



### ç¬¬3ç«  å¹¶å‘æ§åˆ¶

å®ç°äº’æ–¥çš„æ ¹æœ¬å›°éš¾ï¼š**ä¸èƒ½åŒæ—¶è¯»\å†™shared memory**

- load
  - loadåŒæ—¶ä¸èƒ½å†™
  - loadä¸€çœ¼å°±æŠŠçœ¼ç›é—­ä¸Šï¼Œç¥åˆ°çš„æ•°æ®ä¼šè¿‡æ—¶
- store
  - storeåŒæ—¶ä¸èƒ½è¯»ï¼Œå³é—­çœ¼æ“ä½œ



**spin lock**ï¼ˆè½¯ä»¶ä¸å¤Ÿ ç¡¬ä»¶æ¥å‡‘ï¼‰

ç¡¬ä»¶å¢åŠ Atomic exchange (load + store)æŒ‡ä»¤ -- xchg

å†æ¬¡å®ç°petersonåŠŸèƒ½

<img src="https://figure-bed-zwd.oss-cn-hangzhou.aliyuncs.com/img_for_markdown/image-20220820105939433.png" alt="image-20220820105939433" style="zoom:50%;" />

```c++
int xchg(volatile int *addr, int newval) {
  int result;
  asm volatile ("lock xchg %0, %1"
    : "+m"(*addr), "=a"(result) : "1"(newval));
  return result;
}

int locked = 0;
void lock() { 
    while (xchg(&locked, 1)) // è‡ªæ—‹ ç›´è‡³æ¢å‡º0æ¥(0å³ğŸ”‘)
        ; 
}
void unlock() { xchg(&locked, 0); }
```

**è‡ªæ—‹é”ç¼ºé™·**

- è‡ªæ—‹ (å…±äº«å˜é‡) ä¼šè§¦å‘å¤„ç†å™¨é—´çš„ç¼“å­˜åŒæ­¥ï¼Œå»¶è¿Ÿå¢åŠ 
- é™¤äº†è¿›å…¥ä¸´ç•ŒåŒºçš„çº¿ç¨‹ï¼Œå…¶ä»–å¤„ç†å™¨ä¸Šçš„çº¿ç¨‹éƒ½åœ¨ç©ºè½¬
- è·å¾—è‡ªæ—‹é”çš„çº¿ç¨‹å¯èƒ½è¢«æ“ä½œç³»ç»Ÿåˆ‡æ¢å‡ºå»ï¼Œä»è€Œå®ç° 100% çš„èµ„æºæµªè´¹

è‡ªæ—‹é”ä½¿ç”¨åœºæ™¯ï¼š**æ“ä½œç³»ç»Ÿå†…æ ¸çš„å¹¶å‘æ•°æ®ç»“æ„ (çŸ­ä¸´ç•ŒåŒº)**



**mutex lock**ï¼ˆç”¨æˆ·ä¸å¤Ÿ å†…æ ¸æ¥å‡‘ï¼‰

å°†lock & unlockäº¤ç»™æ“ä½œç³»ç»Ÿå®ç°

- çº¿ç¨‹è°ƒç”¨syscallå°è¯•è·å¾—é”
- é˜»å¡ç­‰å¾…syscallè¿”å›
- é˜»å¡æœŸé—´çº¿ç¨‹æœ¬èº«ç¡çœ ï¼ˆé¿å…spin lockçš„å¿™ç­‰å¾…ï¼‰



**Futex**: Fast Userspace muTexes

Futex = Spin + mutex

- Fast path: ä¸€æ¡åŸå­æŒ‡ä»¤ï¼Œä¸Šé”æˆåŠŸç«‹å³è¿”å›
  - spin lock
- Slow path: ä¸Šé”å¤±è´¥ï¼Œæ‰§è¡Œç³»ç»Ÿè°ƒç”¨ç¡çœ 
  - mutex lock

POSIXä¸­pthread_mutex_lockåŸºäºFutexå®ç°



---



**synchronization**

- çº¿ç¨‹åŒæ­¥ï¼š**åœ¨æŸä¸ªæ—¶é—´ç‚¹å…±åŒè¾¾åˆ°äº’ç›¸å·²çŸ¥çš„çŠ¶æ€**

- è¦æ±‚å…ˆåˆ°çš„äººè¦ç­‰ï¼Œç›´åˆ°å¯¹æ–¹å®Œæˆï¼Œ**åœ¨è¯¥æ—¶é—´ç‚¹**ï¼Œä¸¤è€…çŠ¶æ€äº’çŸ¥ï¼Œæ˜¯ä¸ºåŒæ­¥

asynchronous

ä¸çŸ¥é“å¯¹æ–¹æ­£åœ¨å¹²å•¥



**Conditional Variables å®ç°åŒæ­¥**ï¼ˆæ¨èä½¿ç”¨ å¯ä»¥è§£å†³å¤§å¤šæ•°å¹¶å‘é—®é¢˜ï¼‰

- wait(cv, mutex) ğŸ’¤
  - è°ƒç”¨æ—¶å¿…é¡»ä¿è¯å·²ç»è·å¾— mutex
  - é‡Šæ”¾ mutexã€è¿›å…¥ç¡çœ çŠ¶æ€
- signal/notify(cv) ğŸ’¬ ç§ä¿¡ï¼šèµ°èµ·
  - å¦‚æœæœ‰çº¿ç¨‹æ­£åœ¨ç­‰å¾… cvï¼Œåˆ™å”¤é†’å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹
- broadcast/notifyAll(cv) ğŸ“£ æ‰€æœ‰äººï¼šèµ°èµ·
  - å”¤é†’å…¨éƒ¨æ­£åœ¨ç­‰å¾… cv çš„çº¿ç¨‹

cvå…ˆå”¤é†’å†unlockï¼Œ*æé†’å¯¹æ–¹å‡†å¤‡å¥½ï¼Œä¿è¯é‡Šæ”¾é”åç¬¬ä¸€æ—¶é—´æŠ¢åˆ°é”*



**æ¡ä»¶å˜é‡æ­£ç¡®æ‰“å¼€æ–¹å¼**

```c++
mutex_lock(&mutex);
while (!cond) {			// ç­‰å¾…æ¡ä»¶æ»¡è¶³
  wait(&cv, &mutex);
}
assert(cond);
// ...
// äº’æ–¥é”ä¿è¯äº†åœ¨æ­¤æœŸé—´æ¡ä»¶ cond æ€»æ˜¯æˆç«‹
// ...
mutex_unlock(&mutex);	// å…ˆunlock

broadcast(&cv);	// å…¶ä»–çº¿ç¨‹æ¡ä»¶å¯èƒ½è¢«æ»¡è¶³æ—¶
```



**ä¿¡å·é‡semå®ç°åŒæ­¥**

- å®ç°ç”Ÿäº§è€… - æ¶ˆè´¹è€…æ¨¡å‹

- åœ¨ â€œä¸€å•ä½èµ„æºâ€ æ˜ç¡®çš„é—®é¢˜ä¸Šæ›´å¥½ç”¨

```c++
void producer() {
  P(&empty);   // P()è¿”å› -> å¾—åˆ°æ‰‹ç¯
  printf("("); // å‡è®¾çº¿ç¨‹å®‰å…¨
  V(&fill);
}
void consumer() {
  P(&fill);
  printf(")");
  V(&empty);
}
```



**å“²å­¦å®¶åƒé¥­é—®é¢˜**

<img src="https://figure-bed-zwd.oss-cn-hangzhou.aliyuncs.com/img_for_markdown/dining-philosophers.jpg" alt="img" style="zoom: 33%;" />

- ä½¿ç”¨master/slaveæ¨¡å‹è§£å†³

- è®¾ç½®ä¸€ä¸ªwaiterç»Ÿä¸€ç®¡ç†å‰å­

masterä¸æ˜¯distribute systemæ€§èƒ½ç“¶é¢ˆ

Premature optimization is the root of all evil



### ç¬¬4ç«  çœŸå®ä¸–ç•Œçš„å¹¶å‘ç¼–ç¨‹

**é«˜æ€§èƒ½å¹¶è¡Œè®¡ç®—**ï¼Œç±»æ¯”æœ‰é™å…ƒ

- å®¹æ˜“åˆ†è§£çš„å¤æ‚è®¡ç®—é—®é¢˜

- éœ€è¦å¤„ç†åˆ†è§£çš„è¾¹ç•Œï¼Œä½†è¾¹ç•Œä¸å¤æ‚

HPC high performance computer



**æ•°æ®ä¸­å¿ƒçš„ä¸»è¦æŒ‘æˆ˜**

é›¶æ˜Ÿåˆ†å¸ƒçš„ç‚¹æœåŠ¡å™¨ä¸æµ·é‡åˆ†å¸ƒçš„ç”¨æˆ·request

- Consistance
- Available
- Partition tolerance



**çº¿ç¨‹**ï¼Œå¤šå¤„ç†å™¨å¹¶è¡Œconcurrency

- n å¤„ç†å™¨ nçº¿ç¨‹å¯ä»¥å®ç°é«˜æ•ˆçš„å¹¶è¡Œ
- å®é™…éœ€æ±‚çš„å¹¶å‘æ•°é‡è¿œè¿œå¤§äºå¤„ç†å™¨æ•°é‡
- è€Œçº¿ç¨‹åˆ‡æ¢ä»£ä»·é«˜

**åç¨‹**ï¼Œè½»é‡çº§å¹¶å‘parallelism

- ä¿è¯1ä¸ªå¤„ç†å™¨ä¸Šåªè·‘1ä¸ªçº¿ç¨‹ï¼Œæ— æœ‰çº¿ç¨‹åˆ‡æ¢
- çº¿ç¨‹ä¸‹æŒ‚nä¸ªåç¨‹coroutinesï¼Œæ»¡è¶³é«˜å¹¶å‘æ•°é‡éœ€æ±‚
- åç¨‹å®Œå…¨è¿è¡Œåœ¨ç”¨æˆ·æ€ï¼Œä¸æ¶‰åŠå†…æ ¸æ€è°ƒç”¨ï¼Œåˆ‡æ¢ä»£ä»·å°
- Go workerè´Ÿè´£goroutinesè°ƒåº¦



Effective Go

- share memory is the root of all evil
  - æ“ä½œå…±äº«å†…å­˜æ˜¯ä¸€ç§å¾ˆå±é™©çš„è¡Œä¸º

- Do not communicate by sharing memory, share memory by communitcate



å¹¶å‘ç¼–ç¨‹çš„çœŸå®åº”ç”¨åœºæ™¯

- é«˜æ€§èƒ½è®¡ç®— (æ³¨é‡ä»»åŠ¡åˆ†è§£): ç”Ÿäº§è€…-æ¶ˆè´¹è€… (MPI/OpenMP)
- æ•°æ®ä¸­å¿ƒ (æ³¨é‡ç³»ç»Ÿè°ƒç”¨): çº¿ç¨‹-åç¨‹ (Goroutine)
- äººæœºäº¤äº’ (æ³¨é‡æ˜“ç”¨æ€§): äº‹ä»¶-æµå›¾ (Promise)



---



#### å¹¶å‘Bug

- Deadlock

- Data race
- programer fault
  - å¿˜è®°ä¸Šé”ï¼ŒåŸå­æ€§è¿å (Atomicity Violation, AV)
  - å¿˜è®°åŒæ­¥ï¼Œé¡ºåºè¿å (Order Violation, OV) 



**Deadlock**

<img src="https://figure-bed-zwd.oss-cn-hangzhou.aliyuncs.com/img_for_markdown/image-20220826164819747.png" alt="image-20220826164819747" style="zoom:50%;" />





**æ­»é”äº§ç”Ÿçš„å››ä¸ªå¿…è¦æ¡ä»¶** (Edward G. Coffman, 1971)

- äº’æ–¥ï¼šä¸€ä¸ªèµ„æºæ¯æ¬¡åªèƒ½è¢«ä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨

- ç­‰å¾…å¹¶å æœ‰

- éæŠ¢å 

- å¾ªç¯ç­‰å¾…



**lock ordering**

- ç ´åå¾ªç¯ç­‰å¾…æ¡ä»¶
- å¸¸ç”¨é˜²æ­»é”æ–¹æ³•



**Data Race**

T1 T2åŒæ—¶è®¿é—®å†…å­˜ï¼Œä¸”ä¸´ç•ŒåŒºéƒ¨åˆ†æ²¡æœ‰ç¡®å®šçš„å…ˆåæ‰§è¡Œé¡ºåº

- çº¿ç¨‹å†…éƒ¨ä¸ä¼šæ•°æ®ç«äº‰

- é€šè¿‡é”åŒæ­¥çš„å†…å­˜ä¸ä¼šæ•°æ®ç«äº‰



**Lockdepè§„çº¦**

ç”¨äºæ£€æŸ¥æ­»é”

- è¿è¡Œæ—¶è®°å½•ä¸Šé”é¡ºåºæ—¥å¿—
- åˆ†ææ—¥å¿—ï¼Œæ£€æŸ¥æ˜¯å¦å­˜åœ¨<img src="https://figure-bed-zwd.oss-cn-hangzhou.aliyuncs.com/img_for_markdown/image-20220826201426873.png" alt="image-20220826201426873" style="zoom:50%;" />
- ç›¸å½“äºæ£€æŸ¥å›¾ä¸­æ˜¯å¦å­˜åœ¨ç¯

lock orderingæ˜¯ä¸€ç§ä¿å®ˆçš„lockdepå®ç°



**Sanitizer**

gccç¼–è¯‘æä¾›å¤šç§æ¶ˆæ¯’å™¨é€‰é¡¹

- AddressSanitizerï¼Œæ£€æŸ¥éæ³•å†…å­˜è®¿é—®

  - heap-use-after-free

- ThreadSanitizerï¼Œæ£€æŸ¥æ•°æ®ç«äº‰

  ![image-20220826210646099](https://figure-bed-zwd.oss-cn-hangzhou.aliyuncs.com/img_for_markdown/image-20220826210646099.png)

- MemorySanitizerï¼Œæ£€æŸ¥æœªåˆå§‹åŒ–è¯»å–



**canary**

ä¿æŠ¤å†…å­˜åˆ†é…å™¨

- ç‰ºç‰²ä¸€äº›å†…å­˜å•å…ƒï¼Œæ¥é¢„è­¦ memory error çš„å‘ç”Ÿ

- å¤´å°¾å–magicå€¼ï¼Œå¦‚0x55555555



## BashæŒ‡ä»¤

#### ps è¿›ç¨‹çŠ¶æ€æŸ¥çœ‹æŒ‡ä»¤æ—

**ps -l ä»…æŸ¥çœ‹å½“å‰bashç»ˆç«¯ç›¸å…³è¿›ç¨‹çŠ¶æ€**

![image-20220711172819350](https://figure-bed-zwd.oss-cn-hangzhou.aliyuncs.com/img_for_markdown/image-20220711172819350.png)



**ps aux æŸ¥çœ‹å†…å­˜ä¸­æ‰€æœ‰è¿›ç¨‹**â­

ç±»ä¼¼äºwindowsä¸‹çš„ä»»åŠ¡ç®¡ç†å™¨ï¼Œèƒ½æ˜¾ç¤ºcpuå’Œå†…å­˜å ç”¨

![image-20220711173014102](https://figure-bed-zwd.oss-cn-hangzhou.aliyuncs.com/img_for_markdown/image-20220711173014102.png)



**ps ajx æ˜¾ç¤ºè¿›ç¨‹æ ‘ä¿¡æ¯**

è¿›ç¨‹æ ‘ä¿¡æ¯åŒ…æ‹¬çˆ¶è¿›ç¨‹IDã€ç»„é•¿IDã€ä¼šé•¿ID

![image-20220711173513633](https://figure-bed-zwd.oss-cn-hangzhou.aliyuncs.com/img_for_markdown/image-20220711173513633.png)



**ps -ef æŸ¥çœ‹å†…å­˜ä¸­çš„æ‰€æœ‰è¿›ç¨‹ï¼ˆSystem Vé£æ ¼ï¼‰**

ä¸ps auxä½œç”¨ç›¸ä¼¼

![image-20220712005741578](https://figure-bed-zwd.oss-cn-hangzhou.aliyuncs.com/img_for_markdown/image-20220712005741578.png)



#### which æŸ¥çœ‹å‘½ä»¤æ‰€åœ¨ç›®å½•

<img src="https://figure-bed-zwd.oss-cn-hangzhou.aliyuncs.com/img_for_markdown/image-20220607173450685.png" alt="image-20220607173450685" style="zoom: 67%;" />



#### echo è¾“å‡ºå­—ç¬¦ä¸²è‡³ç»ˆç«¯

- $ä¸ºå–å€¼ç¬¦å·
- PATH SHELL ä¸ºç¯å¢ƒå˜é‡å

<img src="https://figure-bed-zwd.oss-cn-hangzhou.aliyuncs.com/img_for_markdown/image-20220607210046270.png" alt="image-20220607210046270" style="zoom:67%;" />

![image-20220607210300129](https://figure-bed-zwd.oss-cn-hangzhou.aliyuncs.com/img_for_markdown/image-20220607210300129.png)





#### ifconfig æŸ¥çœ‹ç½‘å¡ä¿¡æ¯

![image-20220607210630935](https://figure-bed-zwd.oss-cn-hangzhou.aliyuncs.com/img_for_markdown/image-20220607210630935.png)



#### tar å‹ç¼©/è§£å‹ç¼©æ–‡ä»¶

```bash
tar czvf foo.md foo.tar.gz	# å°†foo.mdå‹ç¼©ä¸ºfoo.tar.gz
tar xzvf foo.tar.gz 		# è§£å‹foo.tar.gz
```

å‚æ•°è¯´æ˜

- c -- å‹ç¼©	x -- è§£å‹ç¼©


- z -- ä½¿ç”¨gzipæ–¹å¼å‹ç¼©æ–‡ä»¶ åç¼€ä¸º.gz


- v -- æ˜¾ç¤ºæç¤ºä¿¡æ¯


- f -- æŒ‡å®šå‹ç¼©æ–‡ä»¶å



#### man æŸ¥çœ‹æ¥å£æ‰‹å†Œ

ç³»ç»Ÿæ–‡æ¡£åˆ†1-9ç« èŠ‚ï¼Œ**å¯¹åº”ä¸åŒçš„æ‰‹å†Œç±»å‹**ï¼Œé»˜è®¤è¿”å›ç¬¬ä¸€ä¸ªæ‰¾åˆ°çš„ç»“æœ

- 1	å¯æ‰§è¡Œç¨‹åºæˆ–shellå‘½ä»¤ -- ls tar

- 2	ç³»ç»Ÿè°ƒç”¨ -- open close

- 3	åº“è°ƒç”¨ -- memcpy


```bash
$ man strcpy	# æŸ¥çœ‹cåº“å‡½æ•°ä¸­çš„strcpyå‡½æ•°
```

![image-20220609173020004](https://figure-bed-zwd.oss-cn-hangzhou.aliyuncs.com/img_for_markdown/image-20220609173020004.png)



#### stat æŸ¥çœ‹inodeä¿¡æ¯

![image-20220609162231244](https://figure-bed-zwd.oss-cn-hangzhou.aliyuncs.com/img_for_markdown/image-20220609162231244.png)



#### head/tail æŸ¥çœ‹æ–‡ä»¶å¤´/å°¾

```bash
$ head -n 10 xxx.md	# æŸ¥çœ‹å¤´10è¡Œ
$ tail -n 10 xxx.md	# æŸ¥çœ‹å°¾10è¡Œ
```



#### netstat æŸ¥çœ‹ç½‘ç»œç«¯å£çŠ¶æ€

- -t ä»…æ˜¾ç¤ºtcpç«¯å£

- -u ä»…æ˜¾ç¤ºudpç«¯å£

- -l ä»…æ˜¾ç¤ºç›‘å¬çŠ¶æ€çš„å¥—æ¥å­—

- -n ç›´æ¥ä½¿ç”¨IPåœ°å€ï¼Œè€ŒéåŸŸå

- -p æ˜¾ç¤ºè¯¥ç«¯å£å¯¹åº”çš„pid

**å¯é…åˆgrepæŸ¥æ‰¾æŒ‡å®šç«¯å£**

```bash
$ netstat -tunp		# æŸ¥çœ‹å½“å‰ç³»ç»Ÿçš„tcp udpè¿æ¥
```

![image-20220901161013324](https://figure-bed-zwd.oss-cn-hangzhou.aliyuncs.com/img_for_markdown/image-20220901161013324.png)





#### grep æ–‡æœ¬è¿‡æ»¤

```bash
$ grep "\.h" test.cpp	# æ˜¾ç¤ºtest.cppä¸­ç¬¦åˆ"\.h"patternçš„è¡Œ
```

![image-20220902152355347](https://figure-bed-zwd.oss-cn-hangzhou.aliyuncs.com/img_for_markdown/image-20220902152355347.png)





#### wc è®¡æ•°ç»Ÿè®¡

```bash
$ grep "\.h" test.cpp | wc -l	# -lè¡¨ç¤ºåªæ˜¾ç¤ºè¡Œæ•°
```

![image-20220902155205965](https://figure-bed-zwd.oss-cn-hangzhou.aliyuncs.com/img_for_markdown/image-20220902155205965.png)















































==CS 162 Operator Systerm By Berkeley==